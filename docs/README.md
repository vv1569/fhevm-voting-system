# FHEVM Voting System

ä¸€ä¸ªåŸºäºå…¨åŒæ€åŠ å¯†ï¼ˆFHEï¼‰çš„éšç§ä¿æŠ¤æŠ•ç¥¨ç³»ç»Ÿï¼Œä½¿ç”¨ ZAMA çš„ FHEVM æŠ€æœ¯ç¡®ä¿æŠ•ç¥¨è¿‡ç¨‹çš„å®Œå…¨éšç§æ€§ã€‚

## ğŸŒŸ ç‰¹æ€§

- **å®Œå…¨éšç§ä¿æŠ¤**: ä½¿ç”¨å…¨åŒæ€åŠ å¯†æŠ€æœ¯ï¼ŒæŠ•ç¥¨å†…å®¹åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ä¿æŒåŠ å¯†çŠ¶æ€
- **å»ä¸­å¿ƒåŒ–**: åŸºäºä»¥å¤ªåŠæ™ºèƒ½åˆçº¦çš„å»ä¸­å¿ƒåŒ–æŠ•ç¥¨ç³»ç»Ÿ
- **ç°ä»£åŒ–ç•Œé¢**: å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯
- **æ¨¡å—åŒ–æ¶æ„**: æ¸…æ™°çš„ä»£ç ç»“æ„ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•
- **å®æ—¶çŠ¶æ€**: å®æ—¶æ˜¾ç¤ºæŠ•ç¥¨çŠ¶æ€å’Œç»Ÿè®¡ä¿¡æ¯
- **æµ‹è¯•æ¨¡å¼**: å†…ç½®æµ‹è¯•æ•°æ®ï¼Œä¾¿äºæ¼”ç¤ºå’Œå¼€å‘

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **HTML5/CSS3**: ç°ä»£åŒ–çš„ç”¨æˆ·ç•Œé¢
- **JavaScript (ES6+)**: æ¨¡å—åŒ–çš„å‰ç«¯é€»è¾‘
- **Ethers.js**: ä»¥å¤ªåŠåŒºå—é“¾äº¤äº’
- **FHEVM.js**: å…¨åŒæ€åŠ å¯†åŠŸèƒ½

### åç«¯
- **Node.js**: æœåŠ¡å™¨è¿è¡Œç¯å¢ƒ
- **Express.js**: Web åº”ç”¨æ¡†æ¶
- **Solidity**: æ™ºèƒ½åˆçº¦å¼€å‘è¯­è¨€
- **Hardhat**: å¼€å‘å’Œæµ‹è¯•æ¡†æ¶

### åŒºå—é“¾
- **FHEVM**: ZAMA çš„å…¨åŒæ€åŠ å¯†è™šæ‹Ÿæœº
- **Ethereum**: åº•å±‚åŒºå—é“¾ç½‘ç»œ
- **MetaMask**: é’±åŒ…è¿æ¥

## ğŸ“ é¡¹ç›®ç»“æ„

```
æœºå¯†æŠ•ç¥¨ç³»ç»Ÿ/
â”œâ”€â”€ contracts/                 # æ™ºèƒ½åˆçº¦
â”‚   â””â”€â”€ VotingSystem.sol      # ä¸»æŠ•ç¥¨åˆçº¦
â”œâ”€â”€ public/                   # å‰ç«¯èµ„æº
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ styles.css        # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ js/                   # JavaScript æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ app.js           # ä¸»åº”ç”¨æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ config.js        # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ contract.js      # åˆçº¦äº¤äº’
â”‚   â”‚   â”œâ”€â”€ ui.js            # UI ç®¡ç†
â”‚   â”‚   â””â”€â”€ wallet.js        # é’±åŒ…ç®¡ç†
â”‚   â””â”€â”€ index.html           # ä¸»é¡µé¢
â”œâ”€â”€ scripts/                  # éƒ¨ç½²å’Œå·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ deploy.js            # åˆçº¦éƒ¨ç½²
â”‚   â”œâ”€â”€ check-balance.js     # ä½™é¢æ£€æŸ¥
â”‚   â”œâ”€â”€ analyze-existing.js  # åˆçº¦åˆ†æ
â”‚   â”œâ”€â”€ export-data.js       # æ•°æ®å¯¼å‡º
â”‚   â””â”€â”€ migrate-data.js      # æ•°æ®è¿ç§»
â”œâ”€â”€ test/                     # æµ‹è¯•æ–‡ä»¶
â”‚   â””â”€â”€ VotingSystem.test.js # åˆçº¦æµ‹è¯•
â”œâ”€â”€ docs/                     # æ–‡æ¡£
â”‚   â””â”€â”€ README.md            # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ server.js                # Express æœåŠ¡å™¨
â”œâ”€â”€ hardhat.config.js        # Hardhat é…ç½®
â””â”€â”€ package.json             # é¡¹ç›®ä¾èµ–
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 16.0.0
- npm >= 8.0.0
- MetaMask æµè§ˆå™¨æ‰©å±•
- Git

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone <repository-url>
   cd æœºå¯†æŠ•ç¥¨ç³»ç»Ÿ
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   npm install
   ```

3. **ç¯å¢ƒé…ç½®**
   ```bash
   # å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
   cp .env.example .env
   
   # ç¼–è¾‘ .env æ–‡ä»¶ï¼Œæ·»åŠ å¿…è¦çš„é…ç½®
   # PRIVATE_KEY=your_private_key
   # ETHERSCAN_API_KEY=your_etherscan_api_key
   ```

4. **å¯åŠ¨æœ¬åœ°åŒºå—é“¾**
   ```bash
   npx hardhat node
   ```

5. **éƒ¨ç½²åˆçº¦**
   ```bash
   npx hardhat run scripts/deploy.js --network localhost
   ```

6. **å¯åŠ¨åº”ç”¨**
   ```bash
   npm start
   ```

7. **è®¿é—®åº”ç”¨**
   æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:3000`

## ğŸ“– ä½¿ç”¨æŒ‡å—

### ç®¡ç†å‘˜åŠŸèƒ½

1. **è¿æ¥é’±åŒ…**: ç‚¹å‡»"Connect Wallet"æŒ‰é’®è¿æ¥ MetaMask
2. **æ·»åŠ æŠ•ç¥¨è€…**: åœ¨ç®¡ç†å‘˜é¢æ¿ä¸­æ·»åŠ æˆæƒæŠ•ç¥¨è€…
3. **åˆ›å»ºææ¡ˆ**: åˆ›å»ºæ–°çš„æŠ•ç¥¨ææ¡ˆ
4. **ç®¡ç†æŠ•ç¥¨**: ç›‘æ§æŠ•ç¥¨è¿›åº¦å’Œç»“æœ

### æŠ•ç¥¨è€…åŠŸèƒ½

1. **è¿æ¥é’±åŒ…**: è¿æ¥å·²æˆæƒçš„é’±åŒ…åœ°å€
2. **æŸ¥çœ‹ææ¡ˆ**: æµè§ˆå¯ç”¨çš„æŠ•ç¥¨ææ¡ˆ
3. **å‚ä¸æŠ•ç¥¨**: å¯¹æ„Ÿå…´è¶£çš„ææ¡ˆè¿›è¡ŒæŠ•ç¥¨
4. **æŸ¥çœ‹ç»“æœ**: æŸ¥çœ‹æŠ•ç¥¨ç»Ÿè®¡å’Œç»“æœ

### æµ‹è¯•æ¨¡å¼

ç³»ç»Ÿæä¾›æµ‹è¯•æ¨¡å¼ï¼Œæ— éœ€è¿æ¥çœŸå®åŒºå—é“¾å³å¯ä½“éªŒåŠŸèƒ½ï¼š

1. ç‚¹å‡»"Load Test Data"åŠ è½½æµ‹è¯•ææ¡ˆ
2. åœ¨æµ‹è¯•ææ¡ˆä¸Šè¿›è¡Œæ¨¡æ‹ŸæŠ•ç¥¨
3. æŸ¥çœ‹æŠ•ç¥¨ç»Ÿè®¡å’Œç»“æœ
4. ç‚¹å‡»"Clear Test Data"æ¸…é™¤æµ‹è¯•æ•°æ®

## ğŸ”§ å¼€å‘æŒ‡å—

### ä»£ç ç»“æ„

#### å‰ç«¯æ¨¡å—

- **app.js**: ä¸»åº”ç”¨æ§åˆ¶å™¨ï¼Œè´Ÿè´£æ•´ä½“åº”ç”¨çš„åˆå§‹åŒ–å’Œåè°ƒ
- **config.js**: é…ç½®ç®¡ç†æ¨¡å—ï¼Œå¤„ç†åº”ç”¨é…ç½®çš„åŠ è½½å’ŒéªŒè¯
- **wallet.js**: é’±åŒ…ç®¡ç†æ¨¡å—ï¼Œå¤„ç†é’±åŒ…è¿æ¥ã€çŠ¶æ€ç®¡ç†å’Œäº‹ä»¶ç›‘å¬
- **contract.js**: åˆçº¦äº¤äº’æ¨¡å—ï¼Œå°è£…æ‰€æœ‰æ™ºèƒ½åˆçº¦ç›¸å…³æ“ä½œ
- **ui.js**: UIç®¡ç†æ¨¡å—ï¼Œå¤„ç†ç”¨æˆ·ç•Œé¢æ›´æ–°å’Œäº¤äº’

#### æ™ºèƒ½åˆçº¦

- **VotingSystem.sol**: ä¸»æŠ•ç¥¨åˆçº¦ï¼Œå®ç°æŠ•ç¥¨é€»è¾‘å’Œæƒé™ç®¡ç†

### å¼€å‘å‘½ä»¤

```bash
# ç¼–è¯‘åˆçº¦
npm run compile

# è¿è¡Œæµ‹è¯•
npm test

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
npm run coverage

# ä»£ç æ ¼å¼åŒ–
npm run format

# ä»£ç æ£€æŸ¥
npm run lint

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
npx hardhat test test/VotingSystem.test.js

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run coverage
```

## ğŸ” å®‰å…¨è€ƒè™‘

### éšç§ä¿æŠ¤

- æ‰€æœ‰æŠ•ç¥¨æ•°æ®ä½¿ç”¨ FHE åŠ å¯†
- æŠ•ç¥¨å†…å®¹åœ¨é“¾ä¸Šä¿æŒåŠ å¯†çŠ¶æ€
- åªæœ‰æˆæƒç”¨æˆ·å¯ä»¥å‚ä¸æŠ•ç¥¨

### æ™ºèƒ½åˆçº¦å®‰å…¨

- ä½¿ç”¨ OpenZeppelin å®‰å…¨åº“
- å®æ–½è®¿é—®æ§åˆ¶æœºåˆ¶
- é˜²æ­¢é‡å…¥æ”»å‡»
- è¾“å…¥éªŒè¯å’Œè¾¹ç•Œæ£€æŸ¥

### å‰ç«¯å®‰å…¨

- CSP (Content Security Policy) é…ç½®
- XSS é˜²æŠ¤
- å®‰å…¨çš„å¤–éƒ¨èµ„æºåŠ è½½
- é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

## ğŸŒ éƒ¨ç½²

### æµ‹è¯•ç½‘éƒ¨ç½²

1. **é…ç½®ç½‘ç»œ**
   ```javascript
   // hardhat.config.js
   networks: {
     sepolia: {
       url: "https://sepolia.infura.io/v3/YOUR_INFURA_KEY",
       accounts: [process.env.PRIVATE_KEY]
     }
   }
   ```

2. **éƒ¨ç½²åˆçº¦**
   ```bash
   npx hardhat run scripts/deploy.js --network sepolia
   ```

3. **éªŒè¯åˆçº¦**
   ```bash
   npx hardhat verify --network sepolia DEPLOYED_CONTRACT_ADDRESS
   ```

### ä¸»ç½‘éƒ¨ç½²

âš ï¸ **è­¦å‘Š**: ä¸»ç½‘éƒ¨ç½²å‰è¯·ç¡®ä¿ï¼š
- å®Œæ•´çš„å®‰å…¨å®¡è®¡
- å……åˆ†çš„æµ‹è¯•è¦†ç›–
- å¤‡ä»½å’Œæ¢å¤è®¡åˆ’
- ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ

## ğŸ“Š API æ–‡æ¡£

### REST API

#### å¥åº·æ£€æŸ¥
```
GET /api/health
```
è¿”å›æœåŠ¡å™¨çŠ¶æ€ä¿¡æ¯ã€‚

#### è·å–é…ç½®
```
GET /config.json
```
è¿”å›åº”ç”¨é…ç½®ä¿¡æ¯ã€‚

#### è·å–éƒ¨ç½²ä¿¡æ¯
```
GET /api/deployments
```
è¿”å›åˆçº¦éƒ¨ç½²ä¿¡æ¯ã€‚

### æ™ºèƒ½åˆçº¦ API

#### ç®¡ç†å‘˜åŠŸèƒ½

- `addAuthorizedVoter(address voter, bytes32 encryptedVotingPower, bytes calldata inputProof)`
- `createProposal(string memory title, string memory description, uint256 votingDuration)`

#### æŠ•ç¥¨åŠŸèƒ½

- `vote(uint256 proposalId, bytes32 encryptedVote, bytes calldata inputProof)`
- `getProposal(uint256 proposalId)`
- `getVotingStats(uint256 proposalId)`

#### æŸ¥è¯¢åŠŸèƒ½

- `isAuthorizedVoter(address voter)`
- `hasVoted(uint256 proposalId, address voter)`
- `proposalCount()`

## ğŸ¤ è´¡çŒ®æŒ‡å—

### è´¡çŒ®æµç¨‹

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ ESLint è¿›è¡Œä»£ç æ£€æŸ¥
- éµå¾ª Prettier ä»£ç æ ¼å¼åŒ–è§„åˆ™
- ç¼–å†™æ¸…æ™°çš„æ³¨é‡Šå’Œæ–‡æ¡£
- ä¸ºæ–°åŠŸèƒ½æ·»åŠ æµ‹è¯•

### æäº¤è§„èŒƒ

ä½¿ç”¨ [Conventional Commits](https://www.conventionalcommits.org/) è§„èŒƒï¼š

- `feat:` æ–°åŠŸèƒ½
- `fix:` é”™è¯¯ä¿®å¤
- `docs:` æ–‡æ¡£æ›´æ–°
- `style:` ä»£ç æ ¼å¼åŒ–
- `refactor:` ä»£ç é‡æ„
- `test:` æµ‹è¯•ç›¸å…³
- `chore:` æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

## ğŸ› é—®é¢˜æ’æŸ¥

### å¸¸è§é—®é¢˜

1. **é’±åŒ…è¿æ¥å¤±è´¥**
   - ç¡®ä¿å®‰è£…äº† MetaMask
   - æ£€æŸ¥ç½‘ç»œé…ç½®
   - åˆ·æ–°é¡µé¢é‡è¯•

2. **åˆçº¦äº¤äº’å¤±è´¥**
   - æ£€æŸ¥åˆçº¦åœ°å€é…ç½®
   - ç¡®è®¤è´¦æˆ·æœ‰è¶³å¤Ÿçš„ Gas
   - éªŒè¯ç½‘ç»œè¿æ¥

3. **FHEVM åˆå§‹åŒ–å¤±è´¥**
   - æ£€æŸ¥ FHEVM åº“åŠ è½½
   - ä½¿ç”¨æµ‹è¯•æ¨¡å¼è¿›è¡Œè°ƒè¯•
   - æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

### è°ƒè¯•æŠ€å·§

- ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·
- æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—
- ä½¿ç”¨ Hardhat æœ¬åœ°ç½‘ç»œè¿›è¡Œæµ‹è¯•
- å¯ç”¨è¯¦ç»†æ—¥å¿—è®°å½•

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [ZAMA](https://www.zama.ai/) - æä¾› FHEVM æŠ€æœ¯
- [OpenZeppelin](https://openzeppelin.com/) - æ™ºèƒ½åˆçº¦å®‰å…¨åº“
- [Hardhat](https://hardhat.org/) - å¼€å‘æ¡†æ¶
- [Ethers.js](https://ethers.org/) - ä»¥å¤ªåŠåº“

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- åˆ›å»º [Issue](../../issues)
- å‘é€é‚®ä»¶è‡³: [your-email@example.com]
- åŠ å…¥æˆ‘ä»¬çš„ [Discord](https://discord.gg/your-server)

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œç”¨äºå±•ç¤º FHEVM æŠ€æœ¯çš„åº”ç”¨ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å‰ï¼Œè¯·è¿›è¡Œå……åˆ†çš„å®‰å…¨å®¡è®¡å’Œæµ‹è¯•ã€‚